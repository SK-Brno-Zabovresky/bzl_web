{% extends 'layout.html' %}

{% block head %}
    <title>{{ event_data.name }}</title>
    <script src="https://api.mapy.cz/loader.js"></script>
	<script>Loader.load()</script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style/eventStyle.css') }}">
{% endblock %}

{% block body %}

{% if event_data['name'] %}
    <h1 id="name">
        {{event_data['name']}}
    </h1>
{% endif %}

<div id="border">
{% if event_data['description'] %}
    <h2>
        {{event_data['description']}}
    </h2>
{% endif %}

<!-- Table with basic info -->
<table class="table mt-4">
    <tr>
        <td>Datum:</td><td>{{event_data['date']}}</td>
    </tr>
    {% if event_data['entry_date'] %}
        <tr>
            <td>Přihlášky do:</td><td>{{event_data['entry_date']}}</td>
        </tr>
    {% endif %}
    <tr>
        <td>Web:</td>
        <td>
            <a href="{{ event_data['web'] }}">
                {% if event_data['oris_id'] %}
                    ORIS
                {% elif event_data['web'] %}
                    {{event_data['web']}}
                {% endif %}
            </a>
        </td>
    </tr>
    {% if event_data['place_desc'] %}
        <tr>
            <td>Místo:</td><td>{{event_data['place_desc']}}</td>
        </tr>
    {% endif %}
</table>

<!-- Map -->
{% if event_data['gps_lat'] and event_data['gps_lon'] %}
    <div id="map"></div>
    <script type="text/javascript">
        var center = SMap.Coords.fromWGS84("{{event_data['gps_lon']}}", "{{event_data['gps_lat']}}");
        var map = new SMap(JAK.gel("map"), center, 14);
        map.addDefaultLayer(SMap.DEF_BASE).enable();
        map.addDefaultControls();

        var layer = new SMap.Layer.Marker();
        map.addLayer(layer);
        layer.enable();

        var card = new SMap.Card();
        card.getHeader().innerHTML = "<strong>{{event_data['name']}} - centrum</strong>";
        card.getBody().innerHTML = "{{event_data['place_desc']}}";

        var marker = new SMap.Marker(center, "myMarker");
        marker.decorate(SMap.Marker.Feature.Card, card);
        layer.addMarker(marker);
    </script>
</div>
{% endif %}
{% endblock %}